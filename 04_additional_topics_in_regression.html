<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The R Companion to STATS2 - 4&nbsp; Additional Topics in Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05_one-way_ANOVA.html" rel="next">
<link href="./03_multiple_regression.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_simple_linear_regression.html">Unit A: Linear Regression</a></li><li class="breadcrumb-item"><a href="./04_additional_topics_in_regression.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Additional Topics in Regression</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./STAT2_logo_small.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The R Companion to STATS2</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Unit A: Linear Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_simple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_inference_for_simple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inference for Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_multiple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_additional_topics_in_regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Additional Topics in Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Unit B: Analysis of Variance</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_one-way_ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">One-way ANOVA and Randomized Experiments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_two-way_ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Blocking and Two-way ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_ANOVA_with_interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ANOVA with Interaction and Factorial Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_additional_topics_in_ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Additional Topics in Analysis of Variance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Unit C: Logistic Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_multiple_logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multiple Logistic Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./errata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Corrections</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#added-variable-plots" id="toc-added-variable-plots" class="nav-link active" data-scroll-target="#added-variable-plots"><span class="header-section-number">4.1</span> Added Variable Plots</a></li>
  <li><a href="#techniques-for-choosing-predictors" id="toc-techniques-for-choosing-predictors" class="nav-link" data-scroll-target="#techniques-for-choosing-predictors"><span class="header-section-number">4.2</span> Techniques for Choosing Predictors</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"><span class="header-section-number">4.3</span> Cross-validation</a>
  <ul class="collapse">
  <li><a href="#v-fold-cross-validation" id="toc-v-fold-cross-validation" class="nav-link" data-scroll-target="#v-fold-cross-validation"><span class="header-section-number">4.3.1</span> V-fold Cross Validation</a></li>
  </ul></li>
  <li><a href="#identifying-unusual-points-in-regression" id="toc-identifying-unusual-points-in-regression" class="nav-link" data-scroll-target="#identifying-unusual-points-in-regression"><span class="header-section-number">4.4</span> Identifying Unusual Points in Regression</a></li>
  <li><a href="#coding-categorical-predictors" id="toc-coding-categorical-predictors" class="nav-link" data-scroll-target="#coding-categorical-predictors"><span class="header-section-number">4.5</span> Coding Categorical Predictors</a></li>
  <li><a href="#randomization-test-for-predictors" id="toc-randomization-test-for-predictors" class="nav-link" data-scroll-target="#randomization-test-for-predictors"><span class="header-section-number">4.6</span> Randomization Test for Predictors</a>
  <ul class="collapse">
  <li><a href="#a-randomization-test-for-the-slope" id="toc-a-randomization-test-for-the-slope" class="nav-link" data-scroll-target="#a-randomization-test-for-the-slope"><span class="header-section-number">4.6.1</span> A randomization test for the slope</a></li>
  <li><a href="#a-randomization-test-for-the-correlation" id="toc-a-randomization-test-for-the-correlation" class="nav-link" data-scroll-target="#a-randomization-test-for-the-correlation"><span class="header-section-number">4.6.2</span> A randomization test for the correlation</a></li>
  <li><a href="#randomization-for-inference-in-multiple-regression" id="toc-randomization-for-inference-in-multiple-regression" class="nav-link" data-scroll-target="#randomization-for-inference-in-multiple-regression"><span class="header-section-number">4.6.3</span> Randomization for inference in Multiple Regression</a></li>
  <li><a href="#a-note-about-controlling-randomness" id="toc-a-note-about-controlling-randomness" class="nav-link" data-scroll-target="#a-note-about-controlling-randomness"><span class="header-section-number">4.6.4</span> A note about controlling randomness</a></li>
  </ul></li>
  <li><a href="#bootstrap-for-regression" id="toc-bootstrap-for-regression" class="nav-link" data-scroll-target="#bootstrap-for-regression"><span class="header-section-number">4.7</span> Bootstrap for Regression</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Additional Topics in Regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="added-variable-plots" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="added-variable-plots"><span class="header-section-number">4.1</span> Added Variable Plots</h2>
</section>
<section id="techniques-for-choosing-predictors" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="techniques-for-choosing-predictors"><span class="header-section-number">4.2</span> Techniques for Choosing Predictors</h2>
</section>
<section id="cross-validation" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="cross-validation"><span class="header-section-number">4.3</span> Cross-validation</h2>
<p>Section 4.3 demonstrates cross-validation by dividing the <code>HousesNY</code> data set into two distinct subsets:</p>
<ul>
<li>Two-thirds of the data (35 out of 56 observations) are allocated to a “training” data set, used to fit the <code>Price ~ Size</code> regression model</li>
<li>One-third of the data (the remaining 18 observations) are reserved as a “testing” data set, used to measure the fitted regression model’s predictive performance</li>
</ul>
<p>To replicate this test/training split, we first load the data, and generate a vector of row numbers based on the size of the data set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HousesNY"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>HousesNY</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Price"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Beds"],"name":[2],"type":["int"],"align":["right"]},{"label":["Baths"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Size"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Lot"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"57.6","2":"3","3":"2.0","4":"0.960","5":"1.30"},{"1":"120.0","2":"6","3":"2.0","4":"2.786","5":"0.23"},{"1":"150.0","2":"4","3":"2.0","4":"1.704","5":"0.27"},{"1":"143.0","2":"3","3":"2.0","4":"1.200","5":"0.80"},{"1":"92.5","2":"3","3":"1.0","4":"1.329","5":"0.42"},{"1":"50.0","2":"2","3":"1.0","4":"0.974","5":"0.34"},{"1":"89.0","2":"2","3":"2.0","4":"1.029","5":"0.29"},{"1":"140.0","2":"4","3":"3.0","4":"2.818","5":"0.21"},{"1":"197.5","2":"4","3":"2.5","4":"2.268","5":"1.00"},{"1":"125.1","2":"3","3":"2.0","4":"1.936","5":"0.30"},{"1":"175.0","2":"3","3":"2.0","4":"1.528","5":"1.30"},{"1":"60.0","2":"3","3":"1.0","4":"0.880","5":"1.00"},{"1":"138.5","2":"3","3":"2.0","4":"1.416","5":"0.70"},{"1":"160.0","2":"4","3":"2.0","4":"2.060","5":"0.60"},{"1":"63.5","2":"3","3":"2.0","4":"1.781","5":"0.20"},{"1":"107.0","2":"3","3":"1.0","4":"1.428","5":"2.00"},{"1":"185.0","2":"4","3":"3.5","4":"2.220","5":"0.12"},{"1":"82.7","2":"3","3":"1.0","4":"1.100","5":"2.07"},{"1":"75.0","2":"4","3":"2.0","4":"1.400","5":"0.15"},{"1":"118.0","2":"3","3":"1.0","4":"1.500","5":"0.50"},{"1":"87.5","2":"4","3":"2.0","4":"2.464","5":"0.33"},{"1":"67.5","2":"4","3":"1.0","4":"1.515","5":"0.22"},{"1":"105.0","2":"5","3":"2.0","4":"2.732","5":"0.37"},{"1":"114.0","2":"4","3":"2.0","4":"2.720","5":"2.50"},{"1":"100.5","2":"3","3":"2.0","4":"1.608","5":"0.58"},{"1":"78.0","2":"2","3":"1.0","4":"0.712","5":"1.17"},{"1":"99.0","2":"3","3":"1.0","4":"0.864","5":"1.66"},{"1":"144.0","2":"3","3":"1.5","4":"1.968","5":"0.34"},{"1":"179.0","2":"4","3":"2.0","4":"3.100","5":"0.28"},{"1":"110.0","2":"3","3":"1.5","4":"1.312","5":"0.21"},{"1":"175.0","2":"3","3":"2.0","4":"2.127","5":"1.80"},{"1":"100.0","2":"3","3":"2.0","4":"1.200","5":"3.50"},{"1":"53.0","2":"3","3":"1.0","4":"1.321","5":"0.25"},{"1":"92.0","2":"3","3":"2.0","4":"1.815","5":"0.00"},{"1":"127.0","2":"3","3":"2.0","4":"1.184","5":"0.34"},{"1":"120.5","2":"2","3":"2.0","4":"1.200","5":"2.00"},{"1":"72.0","2":"3","3":"2.0","4":"1.442","5":"0.22"},{"1":"95.0","2":"3","3":"2.0","4":"0.840","5":"1.03"},{"1":"38.5","2":"3","3":"1.0","4":"1.296","5":"1.42"},{"1":"139.0","2":"4","3":"2.0","4":"2.160","5":"0.12"},{"1":"75.0","2":"2","3":"2.0","4":"0.780","5":"0.15"},{"1":"174.0","2":"4","3":"3.0","4":"1.382","5":"0.48"},{"1":"119.0","2":"4","3":"2.0","4":"2.375","5":"0.34"},{"1":"89.0","2":"4","3":"1.0","4":"2.274","5":"1.00"},{"1":"75.1","2":"4","3":"2.0","4":"1.540","5":"0.35"},{"1":"92.5","2":"3","3":"2.0","4":"1.790","5":"0.73"},{"1":"141.0","2":"4","3":"1.0","4":"1.620","5":"0.28"},{"1":"82.0","2":"3","3":"3.0","4":"1.454","5":"2.50"},{"1":"162.0","2":"4","3":"1.5","4":"2.044","5":"0.85"},{"1":"195.0","2":"4","3":"3.0","4":"1.848","5":"1.84"},{"1":"190.0","2":"5","3":"3.5","4":"2.794","5":"0.31"},{"1":"115.0","2":"4","3":"2.0","4":"1.401","5":"1.10"},{"1":"87.0","2":"3","3":"1.5","4":"1.740","5":"0.25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(HousesNY)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
[51] 51 52 53</code></pre>
</div>
</div>
<p>Then, we sample two-third of these rows numbers; these sampled row numbers represent the rows that will become part of our “training” data set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32419</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>training_rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(rows, <span class="at">size =</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">*</span> <span class="fu">nrow</span>(HousesNY))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>training_rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 18  9  3 51 31 25 33  2 37 22 41 29 50  4 40 47 38 13  1 39 32 23 15 17 24
[26]  8 19 43 35 28 34  5 10  7 26</code></pre>
</div>
</div>
<p>The row numbers that were <strong>not</strong> sampled represent the rows that will make up the “testing” data set. We can figure out which rows were <strong>not</strong> sampled by finding the difference between the set of all rows, and the set of sampled rows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>test_rows <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(rows, training_rows)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>test_rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  6 11 12 14 16 20 21 27 30 36 42 44 45 46 48 49 52 53</code></pre>
</div>
</div>
<p>Finally, we can create the test/training split by subsetting the <code>NYHouses</code> data set using these row numbers to indicate which rows should be kept in each subset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> HousesNY[training_rows, ]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>testing <span class="ot">&lt;-</span> HousesNY[test_rows, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can fit the <code>Price ~ Size</code> regression model to the “training” data set, using <code>lm</code> as usual:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>training_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Size, <span class="at">data =</span> training)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(training_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ Size, data = training)

Residuals:
    Min      1Q  Median      3Q     Max 
-59.826 -27.477   1.146  31.444  75.024 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    47.50      17.45   2.723 0.010268 *  
Size           39.22       9.37   4.186 0.000198 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 35.86 on 33 degrees of freedom
Multiple R-squared:  0.3468,    Adjusted R-squared:  0.327 
F-statistic: 17.52 on 1 and 33 DF,  p-value: 0.0001981</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(training_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"22530.19","3":"22530.192","4":"17.51927","5":"0.0001980803","_rn_":"Size"},{"1":"33","2":"42438.78","3":"1286.024","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The model achieves an <span class="math inline">\(R^2\)</span> of 0.3468, and a Mean Square Error of 1286.0237 when fit to the training data set. But how well do these fitted coefficients generalize to the testing data set?</p>
<p>We can compute the predicted price for each home in the “testing” data set by using the <code>augment</code> function from the <code>broom</code> package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">augment</span>(training_model, <span class="at">newdata =</span> testing)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>test_predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".rownames"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Price"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Beds"],"name":[3],"type":["int"],"align":["right"]},{"label":["Baths"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Size"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Lot"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"6","2":"50.0","3":"2","4":"1.0","5":"0.974","6":"0.34","7":"85.69734","8":"-35.697339"},{"1":"11","2":"175.0","3":"3","4":"2.0","5":"1.528","6":"1.30","7":"107.42530","8":"67.574698"},{"1":"12","2":"60.0","3":"3","4":"1.0","5":"0.880","6":"1.00","7":"82.01065","8":"-22.010645"},{"1":"14","2":"160.0","3":"4","4":"2.0","5":"2.060","6":"0.60","7":"128.29042","8":"31.709578"},{"1":"16","2":"107.0","3":"3","4":"1.0","5":"1.428","6":"2.00","7":"103.50329","8":"3.496713"},{"1":"20","2":"118.0","3":"3","4":"1.0","5":"1.500","6":"0.50","7":"106.32714","8":"11.672862"},{"1":"21","2":"87.5","3":"4","4":"2.0","5":"2.464","6":"0.33","7":"144.13536","8":"-56.635362"},{"1":"27","2":"99.0","3":"3","4":"1.0","5":"0.864","6":"1.66","7":"81.38312","8":"17.616877"},{"1":"30","2":"110.0","3":"3","4":"1.5","5":"1.312","6":"0.21","7":"98.95375","8":"11.046250"},{"1":"36","2":"120.5","3":"2","4":"2.0","5":"1.200","6":"2.00","7":"94.56109","8":"25.938907"},{"1":"42","2":"174.0","3":"4","4":"3.0","5":"1.382","6":"0.48","7":"101.69916","8":"72.300840"},{"1":"44","2":"89.0","3":"4","4":"1.0","5":"2.274","6":"1.00","7":"136.68353","8":"-47.683534"},{"1":"45","2":"75.1","3":"4","4":"2.0","5":"1.540","6":"0.35","7":"107.89594","8":"-32.795944"},{"1":"46","2":"92.5","3":"3","4":"2.0","5":"1.790","6":"0.73","7":"117.70098","8":"-25.200981"},{"1":"48","2":"82.0","3":"3","4":"3.0","5":"1.454","6":"2.50","7":"104.52301","8":"-22.523011"},{"1":"49","2":"162.0","3":"4","4":"1.5","5":"2.044","6":"0.85","7":"127.66290","8":"34.337101"},{"1":"52","2":"115.0","3":"4","4":"2.0","5":"1.401","6":"1.10","7":"102.44434","8":"12.555657"},{"1":"53","2":"87.0","3":"3","4":"1.5","5":"1.740","6":"0.25","7":"115.73997","8":"-28.739974"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can compute the <span class="math inline">\(R^2\)</span> statistic for our test data by squaring the correlation between the observed and predicted prices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">R2 =</span> <span class="fu">cor</span>(Price, .fitted)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["R2"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.05757362"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>test_r2 <span class="ot">&lt;-</span> test_predictions <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">R2 =</span> <span class="fu">cor</span>(Price, .fitted)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(R2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we can compute the <span class="math inline">\(MS_{Error}\)</span> using the usual formula <span class="math inline">\(\frac{\sum{(y_i - \hat{y}_i)^2}}{n-k-1}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> Price <span class="sc">-</span> .fitted,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sq_error =</span> error<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">MSE =</span> <span class="fu">sum</span>(sq_error)<span class="sc">/</span>(<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["MSE"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"1479.6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>test_mse <span class="ot">&lt;-</span> test_predictions <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> Price <span class="sc">-</span> .fitted,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sq_error =</span> error<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">MSE =</span> <span class="fu">sum</span>(sq_error)<span class="sc">/</span>(<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(MSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our model performs <em>much</em> worse on the held out “testing” data set! <span class="math inline">\(R^2\)</span> drops from 0.3468 to 0.0576 (a shrinkage of almost 30 percentage points!), and <span class="math inline">\(MS_{error}\)</span> increases to 1479.6001. So it seems that the coefficients estimated based on the sample of 35 houses does not generalize particularly well to new houses.</p>
<p>Note that our results in this replication do not perfectly match the results in Section 4.3, because out training data differs; we have no way of knowing which 35 observations constituted the author’s training data, so we have no way of perfectly replicating their results. This highlights the importance of using <code>set.seed()</code> whenever utilize randomization in your R code; without setting (and sharing!) your RNG seed, your results won’t be replicable!</p>
<section id="v-fold-cross-validation" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="v-fold-cross-validation"><span class="header-section-number">4.3.1</span> V-fold Cross Validation</h3>
<p>When using Cross-Validation as a model selection strategy, it’s uncommon to use a single test/train split. Rather, the “training” data set from the initial split is typically split again into <span class="math inline">\(v\)</span> equally sized smaller subsets. One by one, each of these subsets plays the role of a held-out validation set (on which the model’s predictive accuracy is measured), while the model is fit to the data from all the remaining subsets. The processes of repeatedly fitting the model and assessing it on different, mutually exclusive subsets of the training data is known as <span class="math inline">\(v\)</span>-fold cross validation<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/k-fold.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">An animation of how data is divided iteratively across five folds of cross validation</figcaption>
</figure>
</div>
<p>In <span class="math inline">\(v\)</span>-fold cross validation, each candidate model is fit and “validated” (using a metric such as <span class="math inline">\(R^2\)</span> or <span class="math inline">\(MS_{Error}\)</span>) <span class="math inline">\(v\)</span> different times. The model with the best performance on average across the <span class="math inline">\(v\)</span> held-out validation sets is taken to be the preferred model. Finally, that preferred model is fit to the full training data set, and assessed against the “testing” data set that had been held out all along.</p>
<p>Let’s demonstrate this process by using <span class="math inline">\(v\)</span>-fold cross validation to compare two models:</p>
<ul>
<li><code>Price ~ Baths</code></li>
<li><code>Price ~ Baths + Lot + Beds + Size</code></li>
</ul>
<p>None of the individual <code>Lot</code>, <code>Beds</code>, or <code>Size</code> coefficients are “significant” when added to the model already containing <code>Bath</code>, but these are likely to be important confounders to adjust for when estimating the true effect of the number of bathrooms on price. So, we would like to use the larger model <em>if</em> we aren’t over-fitting the sample and reducing our ability to generalize the model to new homes.</p>
<p>To carry out the cross validation procedure, we’ll use the <code>tidymodels</code> package <span class="citation" data-cites="tidymodels">(<a href="references.html#ref-tidymodels" role="doc-biblioref">Kuhn and Wickham 2020</a>)</span>, which is an “umbrella” package for many different R packages all designed to enable a wide variety of modeling and machine-learning tasks in a systematic ‘pipeline’ by providing a common interface to all these disparate tasks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Whenever one of the functions under the <code>tidymodels</code> umbrella is used, I will prefix that function using the name of the package it comes from, in order to emphasize that the <code>tidymodels</code> package is a collection, not a monolith.</p>
<p>To get started, we’ll creating a new test/train split for our <code>HousesNY</code> data set. This time, we’ll use an 80/20 train/test split (since we need to further subdivide the training data set, it helps to have a larger training set to start with).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">40</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>HousesNY_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  HousesNY,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="fl">0.80</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>HousesNY_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(HousesNY_split)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>HousesNY_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(HousesNY_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we’ll divide the <code>HousesNY_train</code> data into the separate training/validation splits using the <code>vfold_cv</code> function. In the parlance of machine learning, we’re using 3-fold cross validation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>HousesNY_3splits <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(HousesNY_train, <span class="at">v =</span> <span class="dv">3</span>, <span class="at">repeats =</span> <span class="dv">100</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>HousesNY_3splits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["splits"],"name":[1],"type":["list"],"align":["right"]},{"label":["id"],"name":[2],"type":["chr"],"align":["left"]},{"label":["id2"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"<S3: vfold_split>","2":"Repeat001","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat001","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat001","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat002","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat002","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat002","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat003","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat003","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat003","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat004","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat004","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat004","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat005","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat005","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat005","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat006","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat006","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat006","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat007","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat007","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat007","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat008","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat008","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat008","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat009","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat009","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat009","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat010","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat010","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat010","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat011","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat011","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat011","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat012","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat012","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat012","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat013","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat013","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat013","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat014","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat014","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat014","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat015","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat015","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat015","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat016","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat016","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat016","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat017","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat017","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat017","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat018","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat018","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat018","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat019","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat019","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat019","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat020","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat020","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat020","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat021","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat021","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat021","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat022","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat022","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat022","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat023","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat023","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat023","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat024","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat024","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat024","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat025","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat025","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat025","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat026","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat026","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat026","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat027","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat027","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat027","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat028","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat028","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat028","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat029","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat029","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat029","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat030","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat030","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat030","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat031","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat031","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat031","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat032","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat032","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat032","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat033","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat033","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat033","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat034","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat034","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat034","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat035","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat035","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat035","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat036","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat036","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat036","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat037","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat037","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat037","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat038","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat038","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat038","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat039","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat039","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat039","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat040","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat040","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat040","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat041","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat041","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat041","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat042","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat042","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat042","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat043","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat043","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat043","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat044","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat044","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat044","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat045","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat045","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat045","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat046","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat046","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat046","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat047","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat047","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat047","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat048","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat048","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat048","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat049","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat049","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat049","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat050","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat050","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat050","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat051","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat051","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat051","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat052","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat052","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat052","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat053","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat053","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat053","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat054","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat054","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat054","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat055","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat055","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat055","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat056","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat056","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat056","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat057","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat057","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat057","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat058","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat058","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat058","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat059","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat059","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat059","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat060","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat060","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat060","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat061","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat061","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat061","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat062","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat062","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat062","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat063","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat063","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat063","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat064","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat064","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat064","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat065","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat065","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat065","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat066","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat066","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat066","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat067","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat067","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat067","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat068","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat068","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat068","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat069","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat069","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat069","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat070","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat070","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat070","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat071","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat071","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat071","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat072","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat072","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat072","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat073","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat073","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat073","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat074","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat074","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat074","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat075","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat075","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat075","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat076","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat076","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat076","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat077","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat077","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat077","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat078","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat078","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat078","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat079","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat079","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat079","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat080","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat080","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat080","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat081","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat081","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat081","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat082","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat082","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat082","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat083","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat083","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat083","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat084","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat084","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat084","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat085","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat085","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat085","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat086","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat086","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat086","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat087","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat087","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat087","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat088","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat088","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat088","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat089","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat089","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat089","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat090","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat090","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat090","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat091","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat091","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat091","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat092","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat092","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat092","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat093","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat093","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat093","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat094","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat094","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat094","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat095","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat095","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat095","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat096","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat096","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat096","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat097","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat097","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat097","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat098","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat098","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat098","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat099","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat099","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat099","3":"Fold3"},{"1":"<S3: vfold_split>","2":"Repeat100","3":"Fold1"},{"1":"<S3: vfold_split>","2":"Repeat100","3":"Fold2"},{"1":"<S3: vfold_split>","2":"Repeat100","3":"Fold3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cross-validation is usually done with more “folds” (5-fold and 10-fold are common choices). But since our sample size is quite small (there are only 42 observations training data), we’ll keep the number of folds small so that we have a decent number of observations in each held-out validation set.</p>
<p>Since we have such a small sample, there is likely to be considerable variance in the fitted coefficients and accuracy on the held-out validation set across these three splits. To reduce the impact of this variability, we’ll repeat generate 100 different 3-way folds of the training data, and average accuracy across all 300 of the held-out validation sets.</p>
</div>
</div>
<p>Fitting a regression model within the <code>tidymodels</code> framework will feel quite different from how you’re used to fitting a regression model. At first, this will feel overly complicated for no reason. To some degree, it is! The tools of the <code>tidymodels</code> framework are designed to be highly modular and used with nearly <em>any</em> type of model. Since our use case is relatively simple in the grand scheme of things, it does seem to be a bit more trouble than it is worth. However, I feel it is worthwhile to introduce you to this framework (rather than “roll our own” <span class="math inline">\(v\)</span>-fold cross validation) since it represents how cross validation is carried out “in the real world”, and because it’s easier to learn a new framework when the task at hand is relatively simple.</p>
<p>To fit a regression model via the <code>tidymodels</code> framework, we will need to build up three components:</p>
<ul>
<li>A <strong>recipe</strong> that describes the data and variables involved in fitting the model</li>
<li>A <strong>model specification</strong> that describes the type of model, and the “engine” that should be use to fit it</li>
<li>A <strong>workflow</strong>, which is a combination of a recipe and a model specification</li>
</ul>
<p>Let’s start by building the first component we need, a recipe object. Our recipe is quite simple; it specifies our outcome and explanatory variables, and what data set they can be found in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>price_baths_recipe <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  Price <span class="sc">~</span> Baths,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> HousesNY_train</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>price_baths_recipe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, let’s create our model specification. We need to communicate that we want to fit a linear regression model, and we want that model be fit using the <code>lm</code> function. Believe or not, this is a two-step process, because there are actually <em>many</em> different ways to fit a linear model. See the help page at <code>?parsnip::linear_reg()</code> to learn about the 14 different “engines” that can fit a linear regression model!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>linear_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
</div>
<p>Last but not least, we create “workflow” for our modeling process, and add our recipe and our model to that workflow:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>price_baths_workflow  <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(price_baths_recipe) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(linear_model)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>price_baths_workflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
</div>
<p>With all that tedium out of the way, we’re ready to fit out <code>Price ~ Size</code> model to each “fold”, and measure its performance on each held-out validation set. This iterative process is facilitated by the <code>fit_resamples</code> function. The <code>metrics</code> argument indicates that we will evaluate each model’s goodness of fit to the held-out validation set by measuring its <span class="math inline">\(R^2\)</span> (<code>rsq</code>) and its <strong>r</strong>oot <strong>m</strong>ean <strong>s</strong>quared <strong>e</strong>rror (<code>rmse</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>price_baths_fitted <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">fit_resamples</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  price_baths_workflow,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> HousesNY_3splits,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(yardstick<span class="sc">::</span>rmse, yardstick<span class="sc">::</span>rsq)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(price_baths_fitted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]},{"label":["std_err"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".config"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"rmse","2":"standard","3":"36.0565102","4":"300","5":"0.29569730","6":"Preprocessor1_Model1"},{"1":"rsq","2":"standard","3":"0.3243746","4":"300","5":"0.01041565","6":"Preprocessor1_Model1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This output tells us that on average, across the 100 replications of the three-way training/validation splits, the <code>Price ~ Size</code> model achieved an average <span class="math inline">\(R^2\)</span> of .324, and an average root mean squared error of 36.1 on the held-out validation set. Now, let’s do the same thing for the larger <code>Price ~ Size + Lots + Beds + Baths</code> model.</p>
<p>Here, we’ll see the modularity of the <code>tidymodels</code> framework pay off a little bit! Since the only thing changing are the explanatory variables, we can create the new workflow we need by updating the previous workflow object for the <code>Price ~ Size</code> model to use a different collection of variables!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>all_vars_workflow <span class="ot">&lt;-</span> price_baths_workflow <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">remove_recipe</span>() <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_variables</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcomes =</span> Price,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="fu">c</span>(Baths, Size, Lot, Beds)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can carryout the 3-fold cross validation using this updated workflow object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>all_vars_fitted <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">fit_resamples</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  all_vars_workflow,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> HousesNY_3splits,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(yardstick<span class="sc">::</span>rmse, yardstick<span class="sc">::</span>rsq)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(all_vars_fitted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]},{"label":["std_err"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".config"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"rmse","2":"standard","3":"37.0744608","4":"300","5":"0.341899970","6":"Preprocessor1_Model1"},{"1":"rsq","2":"standard","3":"0.3214674","4":"300","5":"0.009375355","6":"Preprocessor1_Model1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The average cross-validated <span class="math inline">\(R^2\)</span> and root mean squared error (RMSE) for the larger model are not much different (.321 and 37.1 vs.&nbsp;.324 and 36.1 for the <code>Price ~ Baths</code> model). But given that it has four times as many explanatory variables, and is actually doing slightly <em>worse</em>, suggests that the <code>Price ~ Baths + Lot + Size + Beds</code> model is over-fitting our observed data and will generalize poorly to new data.</p>
<p>Given that our cross validation procedure favors the reduced <code>Price ~ Size</code> model, let’s put it to the test by re-fitting it to the “full” data set, and evaluating its performance on the <code>HousesNY_test</code> data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>baths_fit <span class="ot">&lt;-</span> price_baths_workflow <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> HousesNY_train)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>baths_preds <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">augment</span>(baths_fit, <span class="at">new_data =</span> HousesNY_test)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">metric_set</span>(yardstick<span class="sc">::</span>rmse, rsq)(baths_preds, <span class="at">truth =</span> Price, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"34.4003780"},{"1":"rsq","2":"standard","3":"0.3199481"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>And just for fun, let’s see how the model we <em>didn’t</em> prefer after cross-validation would fare on the test data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>all_vars_fit <span class="ot">&lt;-</span> all_vars_workflow <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> HousesNY_train)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>all_vars_preds <span class="ot">&lt;-</span> <span class="fu">augment</span>(all_vars_fit, <span class="at">new_data =</span> HousesNY_test)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">metric_set</span>(yardstick<span class="sc">::</span>rmse, rsq)(all_vars_preds, <span class="at">truth =</span> Price, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"34.9749533"},{"1":"rsq","2":"standard","3":"0.2451313"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Just as we suspected: The <code>Price ~ Baths</code> model has higher <span class="math inline">\(R^2\)</span> and lower RMSE on the test data set!</p>
</section>
</section>
<section id="identifying-unusual-points-in-regression" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="identifying-unusual-points-in-regression"><span class="header-section-number">4.4</span> Identifying Unusual Points in Regression</h2>
<p>Section 4.4 introduces four new metrics intended to describe the “unusualness” of individual observations:</p>
<ul>
<li>The <strong>leverage</strong> <span class="math inline">\(h_i\)</span>, which measures how “unusual” an observation is in terms of it’s values across all explanatory variables</li>
<li>The <strong>standardized residual</strong>, which measures how “unusual” an observation’s deviation from the regression model’s predictions is</li>
<li>The <strong>studentized residual</strong>, which also measures how “unusual” an observation’s deviation from the regression model’s predictions is.
<ul>
<li>The only difference between the “standardized” and “studentized” residual statistics for an observation <span class="math inline">\(y_i\)</span> is whether the standard error of the regression is computed <em>including</em> <span class="math inline">\(y_i\)</span> (standardized), or <em>excluding</em> <span class="math inline">\(y_i\)</span> (studentized).</li>
</ul></li>
<li>The <strong>Cook’s Distance</strong> <span class="math inline">\(D_i\)</span>, which measures how “influential” an observation is over the values of the model’s fitted coefficients</li>
</ul>
<p>Section 4.4 applies these metrics to the observations in the <code>PalmBeach</code> data set, after fitting a “simple” linear regression that estimates the number of votes received for Pat Buchanan based on the number of votes received for George W. Bush in the same Florida county. This model (shown as Figure 4.7 in the textbook) is visualized below in <a href="#fig-palm-beach-model">Figure&nbsp;<span>4.1</span></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"PalmBeach"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> PalmBeach,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Bush, <span class="at">y =</span> Buchanan)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-palm-beach-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04_additional_topics_in_regression_files/figure-html/fig-palm-beach-model-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: Votes cast for Pat Buchanan in Florida’s 67 counties in the 2000 U.S. Presdential election, modeled as a linear function of the votes for George W. Bush.</figcaption>
</figure>
</div>
</div>
</div>
<p>The most convenient way to compute the leverage, Cook’s distance, and standardized residuals for each observation is to apply the <code>augment()</code> function (from the <code>broom</code> package) to a fitted model object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>palm_beach_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Buchanan <span class="sc">~</span> Bush, <span class="at">data =</span> PalmBeach)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>influece_metrics <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">augment</span>(palm_beach_model)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>influece_metrics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Buchanan"],"name":[1],"type":["int"],"align":["right"]},{"label":["Bush"],"name":[2],"type":["int"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"262","2":"34062","3":"212.76686","4":"49.233140","5":"0.01532832","6":"356.6226","7":"1.529612e-04","8":"0.1401857886"},{"1":"73","2":"5610","3":"72.87327","4":"0.126733","5":"0.02157204","6":"356.6765","7":"1.444667e-09","8":"0.0003620075"},{"1":"248","2":"38637","3":"235.26135","4":"12.738651","5":"0.01502925","6":"356.6729","7":"1.003441e-05","8":"0.0362663590"},{"1":"65","2":"5413","3":"71.90465","4":"-6.904652","5":"0.02164160","6":"356.6754","7":"4.302604e-06","8":"-0.0197235450"},{"1":"570","2":"115185","3":"611.63471","4":"-41.634707","5":"0.03899504","6":"356.6370","7":"2.921619e-04","8":"-0.1200010035"},{"1":"789","2":"177279","3":"916.94023","4":"-127.940231","5":"0.09859725","6":"356.2785","7":"7.928585e-03","8":"-0.3807499647"},{"1":"90","2":"2873","3":"59.41591","4":"30.584092","5":"0.02257091","6":"356.6556","7":"8.821126e-05","8":"0.0874067826"},{"1":"182","2":"35419","3":"219.43900","4":"-37.438996","5":"0.01521924","6":"356.6453","7":"8.780448e-05","8":"-0.1065973963"},{"1":"270","2":"29744","3":"191.53600","4":"78.464003","5":"0.01578974","6":"356.5395","7":"4.005847e-04","8":"0.2234697268"},{"1":"186","2":"41745","3":"250.54285","4":"-64.542851","5":"0.01493748","6":"356.5839","7":"2.559766e-04","8":"-0.1837419936"},{"1":"122","2":"60426","3":"342.39412","4":"-220.394117","5":"0.01628477","6":"355.5933","7":"3.262851e-03","8":"-0.6278522849"},{"1":"89","2":"10964","3":"99.19796","4":"-10.197965","5":"0.01982019","6":"356.6742","7":"8.564022e-06","8":"-0.0291040083"},{"1":"561","2":"289456","3":"1468.49526","4":"-907.495258","5":"0.29747301","6":"330.0023","7":"1.981366e+00","8":"-3.0591800436"},{"1":"36","2":"4256","3":"66.21588","4":"-30.215882","5":"0.02205745","6":"356.6561","7":"8.405305e-05","8":"-0.0863317966"},{"1":"29","2":"2698","3":"58.55546","4":"-29.555464","5":"0.02263715","6":"356.6569","7":"8.263043e-05","8":"-0.0844699118"},{"1":"650","2":"152082","3":"793.05091","4":"-143.050914","5":"0.07007421","6":"356.1942","7":"6.619074e-03","8":"-0.4191395751"},{"1":"504","2":"73029","3":"404.36090","4":"99.639099","5":"0.01903306","6":"356.4548","7":"7.838155e-04","8":"0.2842462770"},{"1":"83","2":"12608","3":"107.28123","4":"-24.281230","5":"0.01933594","6":"356.6633","7":"4.731736e-05","8":"-0.0692791793"},{"1":"33","2":"2448","3":"57.32626","4":"-24.326256","5":"0.02273228","6":"356.6632","7":"5.622388e-05","8":"-0.0695281516"},{"1":"39","2":"4750","3":"68.64479","4":"-29.644795","5":"0.02187837","6":"356.6568","7":"8.021959e-05","8":"-0.0846923524"},{"1":"29","2":"3300","3":"61.51539","4":"-32.515394","5":"0.02241047","6":"356.6528","7":"9.896243e-05","8":"-0.0929186584"},{"1":"9","2":"1840","3":"54.33682","4":"-45.336825","5":"0.02296607","6":"356.6304","7":"1.973894e-04","8":"-0.1295950635"},{"1":"71","2":"3546","3":"62.72493","4":"8.275066","5":"0.02231882","6":"356.6750","7":"6.382252e-06","8":"0.0236464000"},{"1":"24","2":"2153","3":"55.87579","4":"-31.875792","5":"0.02284528","6":"356.6537","7":"9.703898e-05","8":"-0.0911111441"},{"1":"30","2":"3764","3":"63.79680","4":"-33.796802","5":"0.02223806","6":"356.6509","7":"1.060563e-04","8":"-0.0965720004"},{"1":"22","2":"4743","3":"68.61038","4":"-46.610377","5":"0.02188089","6":"356.6279","7":"1.983358e-04","8":"-0.1331615749"},{"1":"242","2":"30646","3":"195.97098","4":"46.029025","5":"0.01567898","6":"356.6294","7":"1.368554e-04","8":"0.1310857762"},{"1":"99","2":"20196","3":"144.59012","4":"-45.590122","5":"0.01742765","6":"356.6302","7":"1.497634e-04","8":"-0.1299513102"},{"1":"836","2":"176967","3":"915.40618","4":"-79.406181","5":"0.09820784","6":"356.5233","7":"3.039459e-03","8":"-0.2362616662"},{"1":"76","2":"4985","3":"69.80025","4":"6.199751","5":"0.02179398","6":"356.6757","7":"3.494448e-06","8":"0.0177113324"},{"1":"105","2":"28627","3":"186.04390","4":"-81.043900","5":"0.01593742","6":"356.5303","7":"4.314869e-04","8":"-0.2308347296"},{"1":"102","2":"9138","3":"90.21984","4":"11.780163","5":"0.02038761","6":"356.6734","7":"1.176833e-05","8":"0.0336291866"},{"1":"29","2":"2481","3":"57.48851","4":"-28.488512","5":"0.02271969","6":"356.6583","7":"7.706514e-05","8":"-0.0814239877"},{"1":"10","2":"1669","3":"53.49605","4":"-43.496047","5":"0.02303244","6":"356.6341","7":"1.822358e-04","8":"-0.1243374344"},{"1":"289","2":"49963","3":"290.94934","4":"-1.949344","5":"0.01512903","6":"356.6764","7":"2.365832e-07","8":"-0.0055499748"},{"1":"305","2":"106141","3":"567.16691","4":"-262.166914","5":"0.03331541","6":"355.1157","7":"9.781056e-03","8":"-0.7534035530"},{"1":"282","2":"39053","3":"237.30675","4":"44.693251","5":"0.01501174","6":"356.6321","7":"1.233693e-04","8":"0.1272385162"},{"1":"67","2":"6860","3":"79.01930","4":"-12.019302","5":"0.02113910","6":"356.6733","7":"1.272206e-05","8":"-0.0343250312"},{"1":"39","2":"1316","3":"51.76041","4":"-12.760407","5":"0.02317032","6":"356.6729","7":"1.578257e-05","8":"-0.0364793663"},{"1":"29","2":"3038","3":"60.22719","4":"-31.227185","5":"0.02250871","6":"356.6547","7":"9.169484e-05","8":"-0.0892418508"},{"1":"272","2":"57948","3":"330.21022","4":"-58.210216","5":"0.01591874","6":"356.6011","7":"2.223308e-04","8":"-0.1657967122"},{"1":"563","2":"55135","3":"316.37918","4":"246.620821","5":"0.01557267","6":"355.3206","7":"3.901302e-03","8":"0.7023119969"},{"1":"108","2":"33864","3":"211.79333","4":"-103.793328","5":"0.01534567","6":"356.4368","7":"6.806309e-04","8":"-0.2955423496"},{"1":"47","2":"16059","3":"124.24920","4":"-77.249204","5":"0.01840145","6":"356.5433","7":"4.549113e-04","8":"-0.2203024051"},{"1":"90","2":"16404","3":"125.94551","4":"-35.945510","5":"0.01831414","6":"356.6477","7":"9.801333e-05","8":"-0.1025062997"},{"1":"267","2":"52043","3":"301.17635","4":"-34.176347","5":"0.01527744","6":"356.6505","7":"7.345622e-05","8":"-0.0973107615"},{"1":"43","2":"5058","3":"70.15918","4":"-27.159178","5":"0.02176787","6":"356.6600","7":"6.697606e-05","8":"-0.0775867993"},{"1":"446","2":"134476","3":"706.48524","4":"-260.485238","5":"0.05365982","6":"355.1026","7":"1.622838e-02","8":"-0.7565744223"},{"1":"145","2":"26216","3":"174.18943","4":"-29.189427","5":"0.01629587","6":"356.6575","7":"5.727353e-05","8":"-0.0831544510"},{"1":"3407","2":"152846","3":"796.80737","4":"2610.192630","5":"0.07085197","6":"112.4530","7":"2.231935e+00","8":"7.6510719151"},{"1":"570","2":"68581","3":"382.49085","4":"187.509150","5":"0.01789388","6":"355.8915","7":"2.603676e-03","8":"0.5346079795"},{"1":"1010","2":"184312","3":"951.52028","4":"58.479716","5":"0.10761608","6":"356.5926","7":"1.844755e-03","8":"0.1749127914"},{"1":"538","2":"90101","3":"488.30099","4":"49.699009","5":"0.02511932","6":"356.6210","7":"2.605882e-04","8":"0.1422211479"},{"1":"147","2":"13439","3":"111.36711","4":"35.632886","5":"0.01910076","6":"356.6482","7":"1.006140e-04","8":"0.1016555224"},{"1":"229","2":"39497","3":"239.48982","4":"-10.489821","5":"0.01499484","6":"356.6741","7":"6.788210e-06","8":"-0.0298635207"},{"1":"124","2":"34705","3":"215.92838","4":"-91.928381","5":"0.01527449","6":"356.4885","7":"5.313615e-04","8":"-0.2617484970"},{"1":"311","2":"36248","3":"223.51505","4":"87.484953","5":"0.01516106","6":"356.5062","7":"4.775515e-04","8":"0.2490823408"},{"1":"305","2":"83100","3":"453.87828","4":"-148.878277","5":"0.02229450","6":"356.1796","7":"2.063472e-03","8":"-0.4254215488"},{"1":"194","2":"75293","3":"415.49260","4":"-221.492600","5":"0.01968379","6":"355.5787","7":"4.010967e-03","8":"-0.6320745562"},{"1":"114","2":"12126","3":"104.91132","4":"9.088681","5":"0.01947531","6":"356.6747","7":"6.679182e-06","8":"0.0259336578"},{"1":"108","2":"8014","3":"84.69332","4":"23.306678","5":"0.02075236","6":"356.6644","7":"4.692427e-05","8":"0.0665466647"},{"1":"27","2":"4051","3":"65.20793","4":"-38.207932","5":"0.02213243","6":"356.6438","7":"1.348747e-04","8":"-0.1091705980"},{"1":"26","2":"2326","3":"56.72640","4":"-30.726403","5":"0.02277892","6":"356.6554","7":"8.989286e-05","8":"-0.0878228434"},{"1":"396","2":"82214","3":"449.52197","4":"-53.521967","5":"0.02196961","6":"356.6124","7":"2.626250e-04","8":"-0.1529142902"},{"1":"46","2":"4511","3":"67.46967","4":"-21.469673","5":"0.02196472","6":"356.6662","7":"4.224953e-05","8":"-0.0613395163"},{"1":"120","2":"12176","3":"105.15716","4":"14.842840","5":"0.01946075","6":"356.6716","7":"1.779991e-05","8":"0.0423522692"},{"1":"88","2":"4983","3":"69.79042","4":"18.209584","5":"0.02179469","6":"356.6691","7":"3.014707e-05","8":"0.0520208211"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The leverage measurement for each observation is found in the <code>.hat</code> column, the Cook’s Distance metric is found in the <code>.cooksd</code> column, and the standardized residual for each observation is found in the final column, labeled <code>.std.resid</code>.</p>
<p>The only metric <em>not</em> reported here is the studentized residual. We can compute this metric for ourselves calling the <code>rstudent</code> function on our fitted model object, and add it to the data set using <code>dplyr::mutate()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>influece_metrics <span class="ot">&lt;-</span> influece_metrics <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.studentized =</span> <span class="fu">rstudent</span>(palm_beach_model))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>influece_metrics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Buchanan"],"name":[1],"type":["int"],"align":["right"]},{"label":["Bush"],"name":[2],"type":["int"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".studentized"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"262","2":"34062","3":"212.76686","4":"49.233140","5":"0.01532832","6":"356.6226","7":"1.529612e-04","8":"0.1401857886","9":"0.1391242896"},{"1":"73","2":"5610","3":"72.87327","4":"0.126733","5":"0.02157204","6":"356.6765","7":"1.444667e-09","8":"0.0003620075","9":"0.0003592121"},{"1":"248","2":"38637","3":"235.26135","4":"12.738651","5":"0.01502925","6":"356.6729","7":"1.003441e-05","8":"0.0362663590","9":"0.0359866698"},{"1":"65","2":"5413","3":"71.90465","4":"-6.904652","5":"0.02164160","6":"356.6754","7":"4.302604e-06","8":"-0.0197235450","9":"-0.0195712959"},{"1":"570","2":"115185","3":"611.63471","4":"-41.634707","5":"0.03899504","6":"356.6370","7":"2.921619e-04","8":"-0.1200010035","9":"-0.1190875331"},{"1":"789","2":"177279","3":"916.94023","4":"-127.940231","5":"0.09859725","6":"356.2785","7":"7.928585e-03","8":"-0.3807499647","9":"-0.3782317902"},{"1":"90","2":"2873","3":"59.41591","4":"30.584092","5":"0.02257091","6":"356.6556","7":"8.821126e-05","8":"0.0874067826","9":"0.0867369142"},{"1":"182","2":"35419","3":"219.43900","4":"-37.438996","5":"0.01521924","6":"356.6453","7":"8.780448e-05","8":"-0.1065973963","9":"-0.1057834847"},{"1":"270","2":"29744","3":"191.53600","4":"78.464003","5":"0.01578974","6":"356.5395","7":"4.005847e-04","8":"0.2234697268","9":"0.2218292968"},{"1":"186","2":"41745","3":"250.54285","4":"-64.542851","5":"0.01493748","6":"356.5839","7":"2.559766e-04","8":"-0.1837419936","9":"-0.1823704832"},{"1":"122","2":"60426","3":"342.39412","4":"-220.394117","5":"0.01628477","6":"355.5933","7":"3.262851e-03","8":"-0.6278522849","9":"-0.6249017008"},{"1":"89","2":"10964","3":"99.19796","4":"-10.197965","5":"0.01982019","6":"356.6742","7":"8.564022e-06","8":"-0.0291040083","9":"-0.0288794518"},{"1":"561","2":"289456","3":"1468.49526","4":"-907.495258","5":"0.29747301","6":"330.0023","7":"1.981366e+00","8":"-3.0591800436","9":"-3.2809221986"},{"1":"36","2":"4256","3":"66.21588","4":"-30.215882","5":"0.02205745","6":"356.6561","7":"8.405305e-05","8":"-0.0863317966","9":"-0.0856700436"},{"1":"29","2":"2698","3":"58.55546","4":"-29.555464","5":"0.02263715","6":"356.6569","7":"8.263043e-05","8":"-0.0844699118","9":"-0.0838222255"},{"1":"650","2":"152082","3":"793.05091","4":"-143.050914","5":"0.07007421","6":"356.1942","7":"6.619074e-03","8":"-0.4191395751","9":"-0.4164661078"},{"1":"504","2":"73029","3":"404.36090","4":"99.639099","5":"0.01903306","6":"356.4548","7":"7.838155e-04","8":"0.2842462770","9":"0.2822267528"},{"1":"83","2":"12608","3":"107.28123","4":"-24.281230","5":"0.01933594","6":"356.6633","7":"4.731736e-05","8":"-0.0692791793","9":"-0.0687467351"},{"1":"33","2":"2448","3":"57.32626","4":"-24.326256","5":"0.02273228","6":"356.6632","7":"5.622388e-05","8":"-0.0695281516","9":"-0.0689938123"},{"1":"39","2":"4750","3":"68.64479","4":"-29.644795","5":"0.02187837","6":"356.6568","7":"8.021959e-05","8":"-0.0846923524","9":"-0.0840429848"},{"1":"29","2":"3300","3":"61.51539","4":"-32.515394","5":"0.02241047","6":"356.6528","7":"9.896243e-05","8":"-0.0929186584","9":"-0.0922072532"},{"1":"9","2":"1840","3":"54.33682","4":"-45.336825","5":"0.02296607","6":"356.6304","7":"1.973894e-04","8":"-0.1295950635","9":"-0.1286109309"},{"1":"71","2":"3546","3":"62.72493","4":"8.275066","5":"0.02231882","6":"356.6750","7":"6.382252e-06","8":"0.0236464000","9":"0.0234639005"},{"1":"24","2":"2153","3":"55.87579","4":"-31.875792","5":"0.02284528","6":"356.6537","7":"9.703898e-05","8":"-0.0911111441","9":"-0.0904133462"},{"1":"30","2":"3764","3":"63.79680","4":"-33.796802","5":"0.02223806","6":"356.6509","7":"1.060563e-04","8":"-0.0965720004","9":"-0.0958331348"},{"1":"22","2":"4743","3":"68.61038","4":"-46.610377","5":"0.02188089","6":"356.6279","7":"1.983358e-04","8":"-0.1331615749","9":"-0.1321513114"},{"1":"242","2":"30646","3":"195.97098","4":"46.029025","5":"0.01567898","6":"356.6294","7":"1.368554e-04","8":"0.1310857762","9":"0.1300907123"},{"1":"99","2":"20196","3":"144.59012","4":"-45.590122","5":"0.01742765","6":"356.6302","7":"1.497634e-04","8":"-0.1299513102","9":"-0.1289645641"},{"1":"836","2":"176967","3":"915.40618","4":"-79.406181","5":"0.09820784","6":"356.5233","7":"3.039459e-03","8":"-0.2362616662","9":"-0.2345379523"},{"1":"76","2":"4985","3":"69.80025","4":"6.199751","5":"0.02179398","6":"356.6757","7":"3.494448e-06","8":"0.0177113324","9":"0.0175746057"},{"1":"105","2":"28627","3":"186.04390","4":"-81.043900","5":"0.01593742","6":"356.5303","7":"4.314869e-04","8":"-0.2308347296","9":"-0.2291461375"},{"1":"102","2":"9138","3":"90.21984","4":"11.780163","5":"0.02038761","6":"356.6734","7":"1.176833e-05","8":"0.0336291866","9":"0.0333697882"},{"1":"29","2":"2481","3":"57.48851","4":"-28.488512","5":"0.02271969","6":"356.6583","7":"7.706514e-05","8":"-0.0814239877","9":"-0.0807993425"},{"1":"10","2":"1669","3":"53.49605","4":"-43.496047","5":"0.02303244","6":"356.6341","7":"1.822358e-04","8":"-0.1243374344","9":"-0.1233919602"},{"1":"289","2":"49963","3":"290.94934","4":"-1.949344","5":"0.01512903","6":"356.6764","7":"2.365832e-07","8":"-0.0055499748","9":"-0.0055071185"},{"1":"305","2":"106141","3":"567.16691","4":"-262.166914","5":"0.03331541","6":"355.1157","7":"9.781056e-03","8":"-0.7534035530","9":"-0.7508713845"},{"1":"282","2":"39053","3":"237.30675","4":"44.693251","5":"0.01501174","6":"356.6321","7":"1.233693e-04","8":"0.1272385162","9":"0.1262716910"},{"1":"67","2":"6860","3":"79.01930","4":"-12.019302","5":"0.02113910","6":"356.6733","7":"1.272206e-05","8":"-0.0343250312","9":"-0.0340602778"},{"1":"39","2":"1316","3":"51.76041","4":"-12.760407","5":"0.02317032","6":"356.6729","7":"1.578257e-05","8":"-0.0364793663","9":"-0.0361980387"},{"1":"29","2":"3038","3":"60.22719","4":"-31.227185","5":"0.02250871","6":"356.6547","7":"9.169484e-05","8":"-0.0892418508","9":"-0.0885581397"},{"1":"272","2":"57948","3":"330.21022","4":"-58.210216","5":"0.01591874","6":"356.6011","7":"2.223308e-04","8":"-0.1657967122","9":"-0.1645512077"},{"1":"563","2":"55135","3":"316.37918","4":"246.620821","5":"0.01557267","6":"355.3206","7":"3.901302e-03","8":"0.7023119969","9":"0.6995479154"},{"1":"108","2":"33864","3":"211.79333","4":"-103.793328","5":"0.01534567","6":"356.4368","7":"6.806309e-04","8":"-0.2955423496","9":"-0.2934573716"},{"1":"47","2":"16059","3":"124.24920","4":"-77.249204","5":"0.01840145","6":"356.5433","7":"4.549113e-04","8":"-0.2203024051","9":"-0.2186828593"},{"1":"90","2":"16404","3":"125.94551","4":"-35.945510","5":"0.01831414","6":"356.6477","7":"9.801333e-05","8":"-0.1025062997","9":"-0.1017229558"},{"1":"267","2":"52043","3":"301.17635","4":"-34.176347","5":"0.01527744","6":"356.6505","7":"7.345622e-05","8":"-0.0973107615","9":"-0.0965663501"},{"1":"43","2":"5058","3":"70.15918","4":"-27.159178","5":"0.02176787","6":"356.6600","7":"6.697606e-05","8":"-0.0775867993","9":"-0.0769912297"},{"1":"446","2":"134476","3":"706.48524","4":"-260.485238","5":"0.05365982","6":"355.1026","7":"1.622838e-02","8":"-0.7565744223","9":"-0.7540596140"},{"1":"145","2":"26216","3":"174.18943","4":"-29.189427","5":"0.01629587","6":"356.6575","7":"5.727353e-05","8":"-0.0831544510","9":"-0.0825167112"},{"1":"3407","2":"152846","3":"796.80737","4":"2610.192630","5":"0.07085197","6":"112.4530","7":"2.231935e+00","8":"7.6510719151","9":"24.0801444830"},{"1":"570","2":"68581","3":"382.49085","4":"187.509150","5":"0.01789388","6":"355.8915","7":"2.603676e-03","8":"0.5346079795","9":"0.5316497933"},{"1":"1010","2":"184312","3":"951.52028","4":"58.479716","5":"0.10761608","6":"356.5926","7":"1.844755e-03","8":"0.1749127914","9":"0.1736029542"},{"1":"538","2":"90101","3":"488.30099","4":"49.699009","5":"0.02511932","6":"356.6210","7":"2.605882e-04","8":"0.1422211479","9":"0.1411448613"},{"1":"147","2":"13439","3":"111.36711","4":"35.632886","5":"0.01910076","6":"356.6482","7":"1.006140e-04","8":"0.1016555224","9":"0.1008785452"},{"1":"229","2":"39497","3":"239.48982","4":"-10.489821","5":"0.01499484","6":"356.6741","7":"6.788210e-06","8":"-0.0298635207","9":"-0.0296331142"},{"1":"124","2":"34705","3":"215.92838","4":"-91.928381","5":"0.01527449","6":"356.4885","7":"5.313615e-04","8":"-0.2617484970","9":"-0.2598642320"},{"1":"311","2":"36248","3":"223.51505","4":"87.484953","5":"0.01516106","6":"356.5062","7":"4.775515e-04","8":"0.2490823408","9":"0.2472769364"},{"1":"305","2":"83100","3":"453.87828","4":"-148.878277","5":"0.02229450","6":"356.1796","7":"2.063472e-03","8":"-0.4254215488","9":"-0.4227253114"},{"1":"194","2":"75293","3":"415.49260","4":"-221.492600","5":"0.01968379","6":"355.5787","7":"4.010967e-03","8":"-0.6320745562","9":"-0.6291300320"},{"1":"114","2":"12126","3":"104.91132","4":"9.088681","5":"0.01947531","6":"356.6747","7":"6.679182e-06","8":"0.0259336578","9":"0.0257335281"},{"1":"108","2":"8014","3":"84.69332","4":"23.306678","5":"0.02075236","6":"356.6644","7":"4.692427e-05","8":"0.0665466647","9":"0.0660350327"},{"1":"27","2":"4051","3":"65.20793","4":"-38.207932","5":"0.02213243","6":"356.6438","7":"1.348747e-04","8":"-0.1091705980","9":"-0.1083375019"},{"1":"26","2":"2326","3":"56.72640","4":"-30.726403","5":"0.02277892","6":"356.6554","7":"8.989286e-05","8":"-0.0878228434","9":"-0.0871498353"},{"1":"396","2":"82214","3":"449.52197","4":"-53.521967","5":"0.02196961","6":"356.6124","7":"2.626250e-04","8":"-0.1529142902","9":"-0.1517607665"},{"1":"46","2":"4511","3":"67.46967","4":"-21.469673","5":"0.02196472","6":"356.6662","7":"4.224953e-05","8":"-0.0613395163","9":"-0.0608676066"},{"1":"120","2":"12176","3":"105.15716","4":"14.842840","5":"0.01946075","6":"356.6716","7":"1.779991e-05","8":"0.0423522692","9":"0.0420257996"},{"1":"88","2":"4983","3":"69.79042","4":"18.209584","5":"0.02179469","6":"356.6691","7":"3.014707e-05","8":"0.0520208211","9":"0.0516201845"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can use this data set to reproduce Table 4.1, which described the 5 “most unusual” observations in the dataset. These were defined as: observations with a leverage values greater than <span class="math inline">\(\frac{6}{n}\)</span>, <em>or</em> with a absolute standardized residual value greater than 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>influece_metrics <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.hat <span class="sc">&gt;=</span> <span class="dv">6</span><span class="sc">/</span><span class="fu">n</span>() <span class="sc">|</span> <span class="fu">abs</span>(.std.resid) <span class="sc">&gt;</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Buchanan, Bush, .std.resid, .hat, .cooksd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Buchanan"],"name":[1],"type":["int"],"align":["right"]},{"label":["Bush"],"name":[2],"type":["int"],"align":["right"]},{"label":[".std.resid"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"789","2":"177279","3":"-0.3807500","4":"0.09859725","5":"0.007928585"},{"1":"561","2":"289456","3":"-3.0591800","4":"0.29747301","5":"1.981365681"},{"1":"836","2":"176967","3":"-0.2362617","4":"0.09820784","5":"0.003039459"},{"1":"3407","2":"152846","3":"7.6510719","4":"0.07085197","5":"2.231935359"},{"1":"1010","2":"184312","3":"0.1749128","4":"0.10761608","5":"0.001844755"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>If you don’t have a specific criteria in mind for identifying “unusual” observations, the simplest way to identify influential observations is to take a graphical approach, and plot each observation’s standardized residual as a function of it’s leverage.</p>
<p>The <code>check_outliers()</code> function from the <code>performance</code> package returns an object that, when plotted, produces a scatter plot showing the relationship between the leverage and the standardized residuals of each observation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>unusual <span class="ot">&lt;-</span> <span class="fu">check_outliers</span>(palm_beach_model)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(unusual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_additional_topics_in_regression_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The contour line in this plot traces out a Cook’s Distance value that can be used to identify observations that have noticeably strong influence over the values of the fitted coefficients. This visualization identifies two observations (observation 50 and observation 13) as influential. We can use the object returned from <code>check_outliers()</code> to subset the <code>PalmBeach()</code> data, and identify which counties they are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>PalmBeach[unusual, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["County"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Buchanan"],"name":[2],"type":["int"],"align":["right"]},{"label":["Bush"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"DADE","2":"561","3":"289456","_rn_":"13"},{"1":"PALM BEACH","2":"3407","3":"152846","_rn_":"50"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Not surprisingly, observation 50 (the one with the <em>very</em> high standardized residual) is Palm Beach County!</p>
</section>
<section id="coding-categorical-predictors" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="coding-categorical-predictors"><span class="header-section-number">4.5</span> Coding Categorical Predictors</h2>
</section>
<section id="randomization-test-for-predictors" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="randomization-test-for-predictors"><span class="header-section-number">4.6</span> Randomization Test for Predictors</h2>
<p>The treatment of randomization testing is a bit sparse; for a introduction to hypothesis testing with randomization that has more exposition, consult an <a href="https://openintro-ims.netlify.app/foundations-randomization.html">Introduction to Modern Statistics</a> or <a href="https://moderndive.com/8-confidence-intervals.html">ModernDive</a>.</p>
<p>The <a href="https://infer.tidymodels.org/">infer package</a> <span class="citation" data-cites="infer_package">(<a href="references.html#ref-infer_package" role="doc-biblioref">Couch et al. 2021</a>)</span> provides a simple and clear way to perform a randomization test for the slope of a regression model. The idea is that the process of testing the hypothesis “Is there a linear relationship between two numeric variables?” in the NHST framework (<em>without</em> making any distributional assumptions) can be broken down into 5 steps:</p>
<ol type="1">
<li>Specifying the variables of interest</li>
<li>Hypothesizing about their relationship</li>
<li>Generating samples of data from this hypothesized state of the world</li>
<li>Calculating a summary of each sample that measures their relationship in that sample</li>
<li>Calculating the probability of observing your <strong>original</strong> data<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, given the data you’ve observed from your hypothesized state of the world via your simulations in step 3.</li>
</ol>
<p>Steps 1 through 4 describe the process behind creating the null-hypothesis distribution (i.e., the distribution of statistics you would expect to observe <strong>if the null hypothesis were true</strong>), while step 5 describes computing the p-value, so that you can reach a “reject” or “fail to reject” decision for your test. Each of these steps along the way has their own function in the <code>infer</code> package; to perform a hypothesis test, you simply chain these steps together!</p>
<p>Sometimes to understand how something, it’s best to see the whole, big picture, and slowly break it down piece by piece from there. I think this “forest, then tree” approach is useful for understanding the <code>infer</code> package, so to see how the <code>infer</code> package executes a randomization test, we’ll jump ahead to a completed example, and break down each part afterwards.</p>
<section id="a-randomization-test-for-the-slope" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="a-randomization-test-for-the-slope"><span class="header-section-number">4.6.1</span> A randomization test for the slope</h3>
<p>Let’s base our example on the SAT and GPA data used in Example 4.11</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"SATGPA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["MathSAT"],"name":[1],"type":["int"],"align":["right"]},{"label":["VerbalSAT"],"name":[2],"type":["int"],"align":["right"]},{"label":["GPA"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"580","2":"420","3":"2.90"},{"1":"670","2":"530","3":"2.83"},{"1":"680","2":"540","3":"2.90"},{"1":"630","2":"640","3":"3.30"},{"1":"620","2":"630","3":"3.61"},{"1":"580","2":"550","3":"2.75"},{"1":"620","2":"600","3":"2.75"},{"1":"690","2":"500","3":"3.00"},{"1":"520","2":"500","3":"2.77"},{"1":"570","2":"630","3":"2.90"},{"1":"620","2":"550","3":"3.00"},{"1":"690","2":"570","3":"3.25"},{"1":"350","2":"300","3":"3.13"},{"1":"680","2":"570","3":"3.53"},{"1":"550","2":"530","3":"3.10"},{"1":"570","2":"540","3":"3.20"},{"1":"620","2":"640","3":"3.27"},{"1":"750","2":"560","3":"3.30"},{"1":"700","2":"680","3":"2.60"},{"1":"670","2":"550","3":"3.53"},{"1":"680","2":"550","3":"2.67"},{"1":"590","2":"700","3":"3.30"},{"1":"600","2":"650","3":"3.50"},{"1":"630","2":"640","3":"3.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Let’s begin with code that executes Steps 1-4 on our hypothesis testing roadmap:</p>
<div class="cell" data-hash="04_additional_topics_in_regression_cache/html/unnamed-chunk-33_1f5910185e0909ea2466ce00efec134f">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> SATGPA <span class="sc">|&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and break this code down, one line at a time.</p>
<section id="step-1-specify-the-relationship-of-interest" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="step-1-specify-the-relationship-of-interest">Step 1: Specify the relationship of interest</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> SATGPA  <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>specify()</code> function is where you set up the structure of the model using a the familiar formula notation. We’re specifying that we’re interested in the <code>GPA</code> and <code>VerbalSAT</code> relationship, and that we think the <code>VerbalSAT</code> score explains the <code>GPA</code> outcome.</p>
</section>
<section id="step-2-state-your-null-hypothesis" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="step-2-state-your-null-hypothesis">Step 2: State your null hypothesis</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Every null hypothesis test begins with an assumption that the null hypothesis is true. Most of the time, this assumption is implicit, but randomization tests with <code>infer</code> require you to make this assumption explicit.</p>
<p>Writing <code>null = "independene"</code> in this context means you are saying “knowing a persons Verbal SAT score tells me nothing about what their GPA is likely to be”. In other words, you’re saying the the slope of the regression line relating Verbal SAT to GPA is 0 in the entire population of SAT test takers.</p>
</section>
<section id="step-3-generate-new-samples-of-data-by-permuting-our-data" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="step-3-generate-new-samples-of-data-by-permuting-our-data">Step 3: Generate new samples of data by permuting our data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is the most import step in our hypothesis testing “pipeline”: This is where we take each Verbal SAT score from our data, and pair it with a random GPA score that is sampled (without replacement) from our original data as well. We repeated this process 1,000 times, which generates 1,000 new samples of data that are permutations of our original data.</p>
<p>This permutation process is helpful, because it generates 1,000 new data sets <em>where each Verbal SAT score is completely unrelated to it’s paired GPA value</em>. This how the Null Hypothesis says data is generated in the “real world”, and it’s exactly how we’ve generated our permutations. So, these 1,000 new data sets will show us exactly what kinds of GPA and Verbal SAT pairs we’d expect, if the null hypothesis is true!</p>
</section>
<section id="step-4-calculate-the-gpa-verbalsat-slope-from-each-permutation" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="step-4-calculate-the-gpa-verbalsat-slope-from-each-permutation">Step 4: Calculate the <code>GPA ~ VerbalSAT</code> slope from each permutation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since our hypothesis test is about the <em>relationship</em> between GPA and Verbal SAT score, the slope is the statistic that best represents that idea. So, we summarize all of our 1,000 permuted data sets by fitting the <code>GPA ~ VerbalSAT</code> regression model to each one, and extracting the slope coefficient from each. So, the final result from our “pipeline” is 1,000 slopes observed from a world where the null hypothesis of “no relationship” is true!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visualize</span>(null_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_additional_topics_in_regression_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-5-computing-the-p-value" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="step-5-computing-the-p-value">Step 5: Computing the p-value</h4>
<p>Computing the p-value for our hypothesis test means we need to compare the observed slope from our <em>real</em>, unpermuted data to the distribution of slopes we obtained by summarizing our permuted data. Thus, we need the value of the observed slope! You could always do this the “traditional” way, using the <code>lm()</code> function, but since we only need the slope (and not the standard error, or <span class="math inline">\(R^2\)</span>, etc.), let’s demonstrate how you would do this using just <code>specify()</code> and <code>calculate()</code> from the <code>infer</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>observed_slope <span class="ot">&lt;-</span> SATGPA <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>observed_slope</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.0009056089"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Finally, we compute the p-value of our slope by using the <code>get_p_value()</code> function. This function counts number of times our a slope more extreme than the “real” slope resulted from the random permutation process, and dividing that by the total number of permutations performed. Since our question was a generic “is there a relationship?” question (not “is there a positive/negative” relationship), we want to count values in both tails of the null hypothesis distribution as “extreme”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p_value</span>(<span class="at">x =</span> null_dist, <span class="at">obs_stat =</span> observed_slope, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["p_value"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This p-values corresponds to the area in the histogram of permuted slopes that is more extreme than 0.0009.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visualise</span>(null_dist) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> observed_slope, <span class="at">direction =</span> <span class="st">'both'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_additional_topics_in_regression_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With such a large p-value, we fail to reject the null hypothesis, and conclude there is no evidence the two quantities are related in the population of SAT test takers.</p>
</section>
</section>
<section id="a-randomization-test-for-the-correlation" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="a-randomization-test-for-the-correlation"><span class="header-section-number">4.6.2</span> A randomization test for the correlation</h3>
<p>Example 4.11 actually demonstrates a randomization test for the Verbal SAT vs.&nbsp;GPA <em>correlation</em>, the <code>GPA ~ VerbalSAT</code> <em>slope</em>. But, it is easy to execute such a test simply by changing the <code>stat</code> argument of the calculate function from <code>"slope"</code> to <code>"correlation"</code>!</p>
<div class="cell" data-hash="04_additional_topics_in_regression_cache/html/unnamed-chunk-43_76d7d22776f77ac61379f0c4145254db">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>null_correlation_dist <span class="ot">&lt;-</span> SATGPA <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"correlation"</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>observed_correlation <span class="ot">&lt;-</span> SATGPA <span class="sc">|&gt;</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"correlation"</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p_value</span>(null_correlation_dist, <span class="at">obs_stat =</span> observed_correlation,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">direction =</span> <span class="st">"both"</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["p_value"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.276"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visualise</span>(null_correlation_dist) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> observed_correlation, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_additional_topics_in_regression_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="randomization-for-inference-in-multiple-regression" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="randomization-for-inference-in-multiple-regression"><span class="header-section-number">4.6.3</span> Randomization for inference in Multiple Regression</h3>
<p>This random permutation-based procedure can be extended to inference on the coefficients of a multiple regression model as well. All you need to do is:</p>
<ol type="1">
<li>Adapt your formula argument in the <code>specify()</code> function to reflect the structure of your model</li>
<li>Complete your pipeline with the <code>fit()</code> function, instead of the <code>calcuate()</code> function (which makes sense, since there isn’t one single summary statistic for all the relationships encoded by a multiple regression model)</li>
</ol>
<p>For example, we could perform a permutation test on all four of the coefficients in the <code>GPA ~ VerbalSAT * MathSAT</code> model:</p>
<div class="cell" data-hash="04_additional_topics_in_regression_cache/html/unnamed-chunk-44_fbfb4d4f74232866b0060faa4de01044">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>null_models <span class="ot">&lt;-</span> SATGPA <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT <span class="sc">*</span> MathSAT) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>()</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>observed_model <span class="ot">&lt;-</span> SATGPA <span class="sc">|&gt;</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT <span class="sc">*</span> MathSAT) <span class="sc">|&gt;</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>()</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p_value</span>(null_models, <span class="at">obs_stat =</span> observed_model,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">direction =</span> <span class="st">"both"</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p_value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"MathSAT","2":"0.504"},{"1":"VerbalSAT","2":"0.736"},{"1":"VerbalSAT:MathSAT","2":"0.550"},{"1":"intercept","2":"0.692"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visualise</span>(null_models) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> observed_model, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_additional_topics_in_regression_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="a-note-about-controlling-randomness" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="a-note-about-controlling-randomness"><span class="header-section-number">4.6.4</span> A note about controlling randomness</h3>
<p>We’re used to our R code producing identical results every time we run it. For example, we don’t expect the correlation to change the first and second times we calculate it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>SATGPA <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.2444543"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>SATGPA <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.2444543"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>But, things get a bit trickier when we’re constructing the null hypothesis distribution. Consider the example below, where we construct 3 permutations and summarize each one with the correlation coefficient, and then run the exact same code again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>SATGPA <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["replicate"],"name":[1],"type":["int"],"align":["right"]},{"label":["stat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0.1120308"},{"1":"2","2":"-0.2392417"},{"1":"3","2":"-0.4494958"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>SATGPA <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["replicate"],"name":[1],"type":["int"],"align":["right"]},{"label":["stat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0.2640313"},{"1":"2","2":"-0.1512246"},{"1":"3","2":"-0.1903787"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Here, we get 3 different correlations the second time! What’s going on?</p>
<p>The difference is: we’re relying on R’s random number generator to help us randomly shuffle the data to construct our three permutations. The second time we run the code, R generates different random numbers (as we would expect!), yielding different permutations that we obtained during the first execution, and thus three different correlations!</p>
<p>Having no idea what result you’ll get each time you run your code makes it difficult to write about your results, or re-produce them for people who are interested in the “proof” of your work. Luckily, we can take some control over R’s random number generator using the <code>set.seed()</code> function.</p>
<p>The <code>set.seed()</code> function “seeds” R’s random number generator with a fixed value, making the sequence of numbers it generates reproducible between different runs of the same code. Watch what happens when we “seed” the generate with an 11:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>SATGPA <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["replicate"],"name":[1],"type":["int"],"align":["right"]},{"label":["stat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0.183335720"},{"1":"2","2":"0.008415736"},{"1":"3","2":"-0.117482086"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>SATGPA <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(GPA <span class="sc">~</span> VerbalSAT) <span class="sc">|&gt;</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["replicate"],"name":[1],"type":["int"],"align":["right"]},{"label":["stat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0.183335720"},{"1":"2","2":"0.008415736"},{"1":"3","2":"-0.117482086"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now, we get the same correlations each time! It’s recommended that whenever you’re working with R’s random number generator, you set a seed to make your work reproducible. So, don’t forget about the <code>set.seed()</code> function as you’re working on your randomization tests!</p>
<p>Note that you can “seed” R’s random number generator with any positive integer.</p>
</section>
</section>
<section id="bootstrap-for-regression" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="bootstrap-for-regression"><span class="header-section-number">4.7</span> Bootstrap for Regression</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-infer_package" class="csl-entry" role="listitem">
Couch, Simon P., Andrew P. Bray, Chester Ismay, Evgeni Chasnovski, Benjamin S. Baumer, and Mine Çetinkaya-Rundel. 2021. <span>“<span class="nocase">infer</span>: An <span>R</span> Package for Tidyverse-Friendly Statistical Inference.”</span> <em>Journal of Open Source Software</em> 6 (65): 3661. <a href="https://doi.org/10.21105/joss.03661">https://doi.org/10.21105/joss.03661</a>.
</div>
<div id="ref-tidymodels" class="csl-entry" role="listitem">
Kuhn, Max, and Hadley Wickham. 2020. <em>Tidymodels: A Collection of Packages for Modeling and Machine Learning Using Tidyverse Principles.</em> <a href="https://www.tidymodels.org">https://www.tidymodels.org</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>It is also commonly referred to as <span class="math inline">\(k\)</span>-fold validation.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Not your original data <em>exactly</em>; rather, a statistic based on your original data<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03_multiple_regression.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05_one-way_ANOVA.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">One-way ANOVA and Randomized Experiments</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>